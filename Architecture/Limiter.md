# 限流器 (Limiter)

[https://www.cnblogs.com/xiaozengzeng/p/12642394.html](https://www.cnblogs.com/xiaozengzeng/p/12642394.html)

[https://zhuanlan.zhihu.com/p/77083267](https://zhuanlan.zhihu.com/p/77083267)

限流方案:
- 计数器法 (Counter)
    + 方案: 固定一段时间之内，限制最大请求数量，下一周期，重新计算，周而复始
    + 问题: 无法避免周期切换临界时间突发流量问题
- 滑动窗口 (Sliding Window)
    + 方案: 统计周期之内，划分等距窗口，经过一个窗口时间，统计范围向前移动一个窗口周期
    + 问题: 任然无法避免临界时间流量峰值问题
- 令牌桶法 (Token Bucket)
    + 方案: 系统会按恒定1/QPS时间间隔(如果QPS=100，则间隔是10ms)往桶里加入Token，如果桶已经满了就不再加了；新请求来临时,会各自拿走一个Token，如果没有Token可拿了就阻塞或者拒绝服务
    + 问题: 允许突发速率，但是下一个突发速率必须要等桶内有足够的token后才能发生：最大的突发请求不会超过桶的大小
- 漏桶算法 (Leaky Bucket)
    + 方案: 水(请求)先进入到漏桶里，漏桶以一定的速度出水(接口有响应速率)，当水流入速度过大会直接溢出(访问频率超过接口响应速率)，然后就拒绝请求，可以看出漏桶算法能强行限制数据的传输速率
    + 描述: 保证接口会以一个常速速率来处理请求，所以漏桶算法不会出现临界问题
